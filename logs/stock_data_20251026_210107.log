======================================================================
LOG file: logs/stock_data_20251026_210107.log
Start time: 2025-10-26 21:01:07
======================================================================
======================================================================
CHƯƠNG TRÌNH LẤY DỮ LIỆU CỔ PHIẾU TỪ VNSTOCK
======================================================================
Các mã cổ phiếu: ACB, BID, VCB, MBB, FPT
Thời gian: 2015-10-01 đến 2025-10-01
======================================================================

Đang lấy dữ liệu cho mã ACB từ TCBS...
  - Lấy chunk 2015-10-01 -> 2016-09-30 ...
  - Lấy chunk 2016-10-01 -> 2017-10-01 ...
  - Lấy chunk 2017-10-02 -> 2018-10-02 ...
  - Lấy chunk 2018-10-03 -> 2019-10-03 ...
  - Lấy chunk 2019-10-04 -> 2020-10-03 ...
  - Lấy chunk 2020-10-04 -> 2021-10-04 ...
  - Lấy chunk 2021-10-05 -> 2022-10-05 ...
  - Lấy chunk 2022-10-06 -> 2023-10-06 ...
  - Lấy chunk 2023-10-07 -> 2024-10-06 ...
  - Lấy chunk 2024-10-07 -> 2025-10-01 ...
  ✓ Hoàn tất 10 chunk, tổng 2489 dòng
✓ Lấy thành công 2489 dòng dữ liệu cho ACB từ TCBS
Đang lấy dữ liệu cho mã BID từ TCBS...
  - Lấy chunk 2015-10-01 -> 2016-09-30 ...
  - Lấy chunk 2016-10-01 -> 2017-10-01 ...
  - Lấy chunk 2017-10-02 -> 2018-10-02 ...
  - Lấy chunk 2018-10-03 -> 2019-10-03 ...
  - Lấy chunk 2019-10-04 -> 2020-10-03 ...
  - Lấy chunk 2020-10-04 -> 2021-10-04 ...
  - Lấy chunk 2021-10-05 -> 2022-10-05 ...
  - Lấy chunk 2022-10-06 -> 2023-10-06 ...
  - Lấy chunk 2023-10-07 -> 2024-10-06 ...
  - Lấy chunk 2024-10-07 -> 2025-10-01 ...
  ✓ Hoàn tất 10 chunk, tổng 2494 dòng
✓ Lấy thành công 2494 dòng dữ liệu cho BID từ TCBS
Đang lấy dữ liệu cho mã VCB từ TCBS...
  - Lấy chunk 2015-10-01 -> 2016-09-30 ...
  - Lấy chunk 2016-10-01 -> 2017-10-01 ...
  - Lấy chunk 2017-10-02 -> 2018-10-02 ...
  - Lấy chunk 2018-10-03 -> 2019-10-03 ...
  - Lấy chunk 2019-10-04 -> 2020-10-03 ...
  - Lấy chunk 2020-10-04 -> 2021-10-04 ...
  - Lấy chunk 2021-10-05 -> 2022-10-05 ...
  - Lấy chunk 2022-10-06 -> 2023-10-06 ...
  - Lấy chunk 2023-10-07 -> 2024-10-06 ...
  - Lấy chunk 2024-10-07 -> 2025-10-01 ...
  ✓ Hoàn tất 10 chunk, tổng 2494 dòng
✓ Lấy thành công 2494 dòng dữ liệu cho VCB từ TCBS
Đang lấy dữ liệu cho mã MBB từ TCBS...
  - Lấy chunk 2015-10-01 -> 2016-09-30 ...
  - Lấy chunk 2016-10-01 -> 2017-10-01 ...
  - Lấy chunk 2017-10-02 -> 2018-10-02 ...
  - Lấy chunk 2018-10-03 -> 2019-10-03 ...
  - Lấy chunk 2019-10-04 -> 2020-10-03 ...
  - Lấy chunk 2020-10-04 -> 2021-10-04 ...
  - Lấy chunk 2021-10-05 -> 2022-10-05 ...
  - Lấy chunk 2022-10-06 -> 2023-10-06 ...
  - Lấy chunk 2023-10-07 -> 2024-10-06 ...
  - Lấy chunk 2024-10-07 -> 2025-10-01 ...
  ✓ Hoàn tất 10 chunk, tổng 2494 dòng
✓ Lấy thành công 2494 dòng dữ liệu cho MBB từ TCBS
Đang lấy dữ liệu cho mã FPT từ TCBS...
  - Lấy chunk 2015-10-01 -> 2016-09-30 ...
  - Lấy chunk 2016-10-01 -> 2017-10-01 ...
  - Lấy chunk 2017-10-02 -> 2018-10-02 ...
  - Lấy chunk 2018-10-03 -> 2019-10-03 ...
  - Lấy chunk 2019-10-04 -> 2020-10-03 ...
  - Lấy chunk 2020-10-04 -> 2021-10-04 ...
  - Lấy chunk 2021-10-05 -> 2022-10-05 ...
  - Lấy chunk 2022-10-06 -> 2023-10-06 ...
  - Lấy chunk 2023-10-07 -> 2024-10-06 ...
  - Lấy chunk 2024-10-07 -> 2025-10-01 ...
  ✓ Hoàn tất 10 chunk, tổng 2494 dòng
✓ Lấy thành công 2494 dòng dữ liệu cho FPT từ TCBS

======================================================================
THỐNG KÊ DỮ LIỆU
======================================================================
Tổng số dòng (RAW): 12465

Số dòng theo từng mã cổ phiếu:
symbol
ACB    2489
BID    2494
FPT    2494
MBB    2494
VCB    2494
Name: count, dtype: int64

Mẫu dữ liệu (5 dòng đầu):
        time   open   high    low  close   volume symbol
0 2015-10-05   3.11   3.14   3.09   3.13   220204    ACB
1 2015-10-05  11.75  11.90  11.70  11.85   499560    BID
2 2015-10-05   8.19   8.27   8.17   8.25   382440    FPT
3 2015-10-05   2.83   2.89   2.83   2.85  2541890    MBB
4 2015-10-05  13.00  13.12  12.91  13.06   336080    VCB

======================================================================
TÍNH TOÁN CHỈ SỐ KỸ THUẬT
======================================================================
Lấy thêm lookback từ: 2014-08-27 đến 2025-10-01 để tính chỉ báo dài, nhưng output sẽ bị cắt về [2015-10-01..2025-10-01].
Đang lấy dữ liệu cho mã ACB từ TCBS...
  - Lấy chunk 2014-08-27 -> 2015-08-27 ...
  - Lấy chunk 2015-08-28 -> 2016-08-27 ...
  - Lấy chunk 2016-08-28 -> 2017-08-28 ...
  - Lấy chunk 2017-08-29 -> 2018-08-29 ...
  - Lấy chunk 2018-08-30 -> 2019-08-30 ...
  - Lấy chunk 2019-08-31 -> 2020-08-30 ...
  - Lấy chunk 2020-08-31 -> 2021-08-31 ...
  - Lấy chunk 2021-09-01 -> 2022-09-01 ...
  - Lấy chunk 2022-09-02 -> 2023-09-02 ...
  - Lấy chunk 2023-09-03 -> 2024-09-02 ...
  - Lấy chunk 2024-09-03 -> 2025-09-03 ...
  - Lấy chunk 2025-09-04 -> 2025-10-01 ...
  ✓ Hoàn tất 12 chunk, tổng 2765 dòng
✓ Lấy thành công 2765 dòng dữ liệu cho ACB từ TCBS
Đang lấy dữ liệu cho mã BID từ TCBS...
  - Lấy chunk 2014-08-27 -> 2015-08-27 ...
  - Lấy chunk 2015-08-28 -> 2016-08-27 ...
  - Lấy chunk 2016-08-28 -> 2017-08-28 ...
  - Lấy chunk 2017-08-29 -> 2018-08-29 ...
  - Lấy chunk 2018-08-30 -> 2019-08-30 ...
  - Lấy chunk 2019-08-31 -> 2020-08-30 ...
  - Lấy chunk 2020-08-31 -> 2021-08-31 ...
  - Lấy chunk 2021-09-01 -> 2022-09-01 ...
  - Lấy chunk 2022-09-02 -> 2023-09-02 ...
  - Lấy chunk 2023-09-03 -> 2024-09-02 ...
  - Lấy chunk 2024-09-03 -> 2025-09-03 ...
  - Lấy chunk 2025-09-04 -> 2025-10-01 ...
  ✓ Hoàn tất 12 chunk, tổng 2768 dòng
✓ Lấy thành công 2768 dòng dữ liệu cho BID từ TCBS
Đang lấy dữ liệu cho mã VCB từ TCBS...
  - Lấy chunk 2014-08-27 -> 2015-08-27 ...
  - Lấy chunk 2015-08-28 -> 2016-08-27 ...
  - Lấy chunk 2016-08-28 -> 2017-08-28 ...
  - Lấy chunk 2017-08-29 -> 2018-08-29 ...
  - Lấy chunk 2018-08-30 -> 2019-08-30 ...
  - Lấy chunk 2019-08-31 -> 2020-08-30 ...
  - Lấy chunk 2020-08-31 -> 2021-08-31 ...
  - Lấy chunk 2021-09-01 -> 2022-09-01 ...
  - Lấy chunk 2022-09-02 -> 2023-09-02 ...
  - Lấy chunk 2023-09-03 -> 2024-09-02 ...
  - Lấy chunk 2024-09-03 -> 2025-09-03 ...
  - Lấy chunk 2025-09-04 -> 2025-10-01 ...
  ✓ Hoàn tất 12 chunk, tổng 2768 dòng
✓ Lấy thành công 2768 dòng dữ liệu cho VCB từ TCBS
Đang lấy dữ liệu cho mã MBB từ TCBS...
  - Lấy chunk 2014-08-27 -> 2015-08-27 ...
  - Lấy chunk 2015-08-28 -> 2016-08-27 ...
  - Lấy chunk 2016-08-28 -> 2017-08-28 ...
  - Lấy chunk 2017-08-29 -> 2018-08-29 ...
  - Lấy chunk 2018-08-30 -> 2019-08-30 ...
  - Lấy chunk 2019-08-31 -> 2020-08-30 ...
  - Lấy chunk 2020-08-31 -> 2021-08-31 ...
  - Lấy chunk 2021-09-01 -> 2022-09-01 ...
  - Lấy chunk 2022-09-02 -> 2023-09-02 ...
  - Lấy chunk 2023-09-03 -> 2024-09-02 ...
  - Lấy chunk 2024-09-03 -> 2025-09-03 ...
  - Lấy chunk 2025-09-04 -> 2025-10-01 ...
  ✓ Hoàn tất 12 chunk, tổng 2768 dòng
✓ Lấy thành công 2768 dòng dữ liệu cho MBB từ TCBS
Đang lấy dữ liệu cho mã FPT từ TCBS...
  - Lấy chunk 2014-08-27 -> 2015-08-27 ...
  - Lấy chunk 2015-08-28 -> 2016-08-27 ...
  - Lấy chunk 2016-08-28 -> 2017-08-28 ...
  - Lấy chunk 2017-08-29 -> 2018-08-29 ...
  - Lấy chunk 2018-08-30 -> 2019-08-30 ...
  - Lấy chunk 2019-08-31 -> 2020-08-30 ...
  - Lấy chunk 2020-08-31 -> 2021-08-31 ...
  - Lấy chunk 2021-09-01 -> 2022-09-01 ...
  - Lấy chunk 2022-09-02 -> 2023-09-02 ...
  - Lấy chunk 2023-09-03 -> 2024-09-02 ...
  - Lấy chunk 2024-09-03 -> 2025-09-03 ...
  - Lấy chunk 2025-09-04 -> 2025-10-01 ...
  ✓ Hoàn tất 12 chunk, tổng 2768 dòng
✓ Lấy thành công 2768 dòng dữ liệu cho FPT từ TCBS

Xử lý mã ACB...
Đang tính toán chỉ số kỹ thuật...
✓ Đã tính toán xong các chỉ số kỹ thuật!
  - Số lượng chỉ số đã thêm: 60

Xử lý mã BID...
Đang tính toán chỉ số kỹ thuật...
✓ Đã tính toán xong các chỉ số kỹ thuật!
  - Số lượng chỉ số đã thêm: 60

Xử lý mã FPT...
Đang tính toán chỉ số kỹ thuật...
✓ Đã tính toán xong các chỉ số kỹ thuật!
  - Số lượng chỉ số đã thêm: 60

Xử lý mã MBB...
Đang tính toán chỉ số kỹ thuật...
✓ Đã tính toán xong các chỉ số kỹ thuật!
  - Số lượng chỉ số đã thêm: 60

Xử lý mã VCB...
Đang tính toán chỉ số kỹ thuật...
✓ Đã tính toán xong các chỉ số kỹ thuật!
  - Số lượng chỉ số đã thêm: 60

Đối chiếu số dòng giữa RAW và WITH_INDICATORS...
  - RAW rows: 12465
  - IND rows: 12442
  ! Cảnh báo: số dòng chưa khớp. Sẽ ép khớp lại theo (time,symbol) ở RAW.
  - IND rows sau khi ép khớp: 12465

Loại bỏ cột ít dữ liệu: ['PSAR_up', 'PSAR_down'] (giữ PSAR_filled, PSAR_side)

✓ Đã lưu dữ liệu vào file: stock_data_2025_with_indicators.csv
  - Tổng số dòng: 12465
  - Các cột: time, open, high, low, close, volume, symbol, SMA_5, SMA_10, SMA_20, SMA_50, SMA_200, EMA_5, EMA_10, EMA_20, EMA_50, RSI_14, RSI_7, MACD, MACD_signal, MACD_diff, BB_upper, BB_middle, BB_lower, BB_width, BB_pband, Stoch_K, Stoch_D, ATR_14, ADX, ADX_pos, ADX_neg, OBV, CCI_20, Williams_R, MFI_14, ROC_10, PSAR, PSAR_merged, PSAR_side, PSAR_filled, VWAP, Ichimoku_a, Ichimoku_b, Ichimoku_base, Ichimoku_conv, TRIX, KST, KST_signal, CMF, Force_Index, EOM, Keltner_upper, Keltner_middle, Keltner_lower, Donchian_upper, Donchian_middle, Donchian_lower, Ulcer_Index, Daily_Return, Price_Change, Price_Change_Pct, HL_Range, HL_Range_Pct, Volume_Change_Pct
  - Thời gian: 2015-10-05 00:00:00 đến 2025-10-01 00:00:00

✓ Đã lưu dữ liệu vào file: stock_data_2025_raw.csv
  - Tổng số dòng: 12465
  - Các cột: time, open, high, low, close, volume, symbol
  - Thời gian: 2015-10-05 00:00:00 đến 2025-10-01 00:00:00

======================================================================
MẪU DỮ LIỆU WITH_INDICATORS (5 DÒNG ĐẦU)
======================================================================
        time   open   high    low  ...  Price_Change_Pct  HL_Range HL_Range_Pct  Volume_Change_Pct
0 2015-10-05   3.11   3.14   3.09  ...          0.643087      0.05     1.618123          38.759255
1 2015-10-05  11.75  11.90  11.70  ...          0.851064      0.20     1.709402          16.512734
2 2015-10-05   8.19   8.27   8.17  ...          0.732601      0.10     1.223990         179.418426
3 2015-10-05   2.83   2.89   2.83  ...          0.706714      0.06     2.120141         179.006641
4 2015-10-05  13.00  13.12  12.91  ...          0.461538      0.21     1.626646          -2.984816

[5 rows x 65 columns]

======================================================================
HOÀN THÀNH!
======================================================================
