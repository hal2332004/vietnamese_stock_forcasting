======================================================================
LOG file: logs/stock_data_20251019_204609.log
Start time: 2025-10-19 20:46:09
======================================================================
======================================================================
CHƯƠNG TRÌNH LẤY DỮ LIỆU CỔ PHIẾU TỪ VNSTOCK
======================================================================
Các mã cổ phiếu: ACB, BID, VCB, MBB, FPT
Thời gian: 2015-01-01 đến 2025-10-01
======================================================================

Đang lấy dữ liệu cho mã ACB từ TCBS...
  - Lấy chunk 2015-01-01 -> 2016-01-01 ...
  - Lấy chunk 2016-01-02 -> 2017-01-01 ...
  - Lấy chunk 2017-01-02 -> 2018-01-02 ...
  - Lấy chunk 2018-01-03 -> 2019-01-03 ...
  - Lấy chunk 2019-01-04 -> 2020-01-04 ...
  - Lấy chunk 2020-01-05 -> 2021-01-04 ...
  - Lấy chunk 2021-01-05 -> 2022-01-05 ...
  - Lấy chunk 2022-01-06 -> 2023-01-06 ...
  - Lấy chunk 2023-01-07 -> 2024-01-07 ...
  - Lấy chunk 2024-01-08 -> 2025-01-07 ...
  - Lấy chunk 2025-01-08 -> 2025-10-01 ...
  ✓ Hoàn tất 11 chunk, tổng 2675 dòng
✓ Lấy thành công 2675 dòng dữ liệu cho ACB từ TCBS
Đang lấy dữ liệu cho mã BID từ TCBS...
  - Lấy chunk 2015-01-01 -> 2016-01-01 ...
  - Lấy chunk 2016-01-02 -> 2017-01-01 ...
  - Lấy chunk 2017-01-02 -> 2018-01-02 ...
  - Lấy chunk 2018-01-03 -> 2019-01-03 ...
  - Lấy chunk 2019-01-04 -> 2020-01-04 ...
  - Lấy chunk 2020-01-05 -> 2021-01-04 ...
  - Lấy chunk 2021-01-05 -> 2022-01-05 ...
  - Lấy chunk 2022-01-06 -> 2023-01-06 ...
  - Lấy chunk 2023-01-07 -> 2024-01-07 ...
  - Lấy chunk 2024-01-08 -> 2025-01-07 ...
  - Lấy chunk 2025-01-08 -> 2025-10-01 ...
  ✓ Hoàn tất 11 chunk, tổng 2679 dòng
✓ Lấy thành công 2679 dòng dữ liệu cho BID từ TCBS
Đang lấy dữ liệu cho mã VCB từ TCBS...
  - Lấy chunk 2015-01-01 -> 2016-01-01 ...
  - Lấy chunk 2016-01-02 -> 2017-01-01 ...
  - Lấy chunk 2017-01-02 -> 2018-01-02 ...
  - Lấy chunk 2018-01-03 -> 2019-01-03 ...
  - Lấy chunk 2019-01-04 -> 2020-01-04 ...
  - Lấy chunk 2020-01-05 -> 2021-01-04 ...
  - Lấy chunk 2021-01-05 -> 2022-01-05 ...
  - Lấy chunk 2022-01-06 -> 2023-01-06 ...
  - Lấy chunk 2023-01-07 -> 2024-01-07 ...
  - Lấy chunk 2024-01-08 -> 2025-01-07 ...
  - Lấy chunk 2025-01-08 -> 2025-10-01 ...
  ✓ Hoàn tất 11 chunk, tổng 2679 dòng
✓ Lấy thành công 2679 dòng dữ liệu cho VCB từ TCBS
Đang lấy dữ liệu cho mã MBB từ TCBS...
  - Lấy chunk 2015-01-01 -> 2016-01-01 ...
  - Lấy chunk 2016-01-02 -> 2017-01-01 ...
  - Lấy chunk 2017-01-02 -> 2018-01-02 ...
  - Lấy chunk 2018-01-03 -> 2019-01-03 ...
  - Lấy chunk 2019-01-04 -> 2020-01-04 ...
  - Lấy chunk 2020-01-05 -> 2021-01-04 ...
  - Lấy chunk 2021-01-05 -> 2022-01-05 ...
  - Lấy chunk 2022-01-06 -> 2023-01-06 ...
  - Lấy chunk 2023-01-07 -> 2024-01-07 ...
  - Lấy chunk 2024-01-08 -> 2025-01-07 ...
  - Lấy chunk 2025-01-08 -> 2025-10-01 ...
  ✓ Hoàn tất 11 chunk, tổng 2679 dòng
✓ Lấy thành công 2679 dòng dữ liệu cho MBB từ TCBS
Đang lấy dữ liệu cho mã FPT từ TCBS...
  - Lấy chunk 2015-01-01 -> 2016-01-01 ...
  - Lấy chunk 2016-01-02 -> 2017-01-01 ...
  - Lấy chunk 2017-01-02 -> 2018-01-02 ...
  - Lấy chunk 2018-01-03 -> 2019-01-03 ...
  - Lấy chunk 2019-01-04 -> 2020-01-04 ...
  - Lấy chunk 2020-01-05 -> 2021-01-04 ...
  - Lấy chunk 2021-01-05 -> 2022-01-05 ...
  - Lấy chunk 2022-01-06 -> 2023-01-06 ...
  - Lấy chunk 2023-01-07 -> 2024-01-07 ...
  - Lấy chunk 2024-01-08 -> 2025-01-07 ...
  - Lấy chunk 2025-01-08 -> 2025-10-01 ...
  ✓ Hoàn tất 11 chunk, tổng 2679 dòng
✓ Lấy thành công 2679 dòng dữ liệu cho FPT từ TCBS

======================================================================
THỐNG KÊ DỮ LIỆU
======================================================================
Tổng số dòng (RAW): 13381

Số dòng theo từng mã cổ phiếu:
symbol
ACB    2673
BID    2677
FPT    2677
MBB    2677
VCB    2677
Name: count, dtype: int64

Mẫu dữ liệu (5 dòng đầu):
        time  open  high   low  close  volume symbol
0 2015-01-05  2.35  2.34  2.31   2.34   55888    ACB
1 2015-01-05  5.84  5.89  5.84   5.84   66380    BID
2 2015-01-05  7.34  7.37  7.28   7.31  273550    FPT
3 2015-01-05  2.31  2.31  2.29   2.29  338650    MBB
4 2015-01-05  9.32  9.44  9.23   9.38  310010    VCB

======================================================================
TÍNH TOÁN CHỈ SỐ KỸ THUẬT
======================================================================
Lấy thêm lookback từ: 2013-11-27 đến 2025-10-01 để tính chỉ báo dài, nhưng output sẽ bị cắt về [2015-01-01..2025-10-01].
Đang lấy dữ liệu cho mã ACB từ TCBS...
  - Lấy chunk 2013-11-27 -> 2014-11-27 ...
  - Lấy chunk 2014-11-28 -> 2015-11-28 ...
  - Lấy chunk 2015-11-29 -> 2016-11-28 ...
  - Lấy chunk 2016-11-29 -> 2017-11-29 ...
  - Lấy chunk 2017-11-30 -> 2018-11-30 ...
  - Lấy chunk 2018-12-01 -> 2019-12-01 ...
  - Lấy chunk 2019-12-02 -> 2020-12-01 ...
  - Lấy chunk 2020-12-02 -> 2021-12-02 ...
  - Lấy chunk 2021-12-03 -> 2022-12-03 ...
  - Lấy chunk 2022-12-04 -> 2023-12-04 ...
  - Lấy chunk 2023-12-05 -> 2024-12-04 ...
  - Lấy chunk 2024-12-05 -> 2025-10-01 ...
  ✓ Hoàn tất 12 chunk, tổng 2945 dòng
✓ Lấy thành công 2945 dòng dữ liệu cho ACB từ TCBS
Đang lấy dữ liệu cho mã BID từ TCBS...
  - Lấy chunk 2013-11-27 -> 2014-11-27 ...
  - Lấy chunk 2014-11-28 -> 2015-11-28 ...
  - Lấy chunk 2015-11-29 -> 2016-11-28 ...
  - Lấy chunk 2016-11-29 -> 2017-11-29 ...
  - Lấy chunk 2017-11-30 -> 2018-11-30 ...
  - Lấy chunk 2018-12-01 -> 2019-12-01 ...
  - Lấy chunk 2019-12-02 -> 2020-12-01 ...
  - Lấy chunk 2020-12-02 -> 2021-12-02 ...
  - Lấy chunk 2021-12-03 -> 2022-12-03 ...
  - Lấy chunk 2022-12-04 -> 2023-12-04 ...
  - Lấy chunk 2023-12-05 -> 2024-12-04 ...
  - Lấy chunk 2024-12-05 -> 2025-10-01 ...
  ✓ Hoàn tất 12 chunk, tổng 2906 dòng
✓ Lấy thành công 2906 dòng dữ liệu cho BID từ TCBS
Đang lấy dữ liệu cho mã VCB từ TCBS...
  - Lấy chunk 2013-11-27 -> 2014-11-27 ...
  - Lấy chunk 2014-11-28 -> 2015-11-28 ...
  - Lấy chunk 2015-11-29 -> 2016-11-28 ...
  - Lấy chunk 2016-11-29 -> 2017-11-29 ...
  - Lấy chunk 2017-11-30 -> 2018-11-30 ...
  - Lấy chunk 2018-12-01 -> 2019-12-01 ...
  - Lấy chunk 2019-12-02 -> 2020-12-01 ...
  - Lấy chunk 2020-12-02 -> 2021-12-02 ...
  - Lấy chunk 2021-12-03 -> 2022-12-03 ...
  - Lấy chunk 2022-12-04 -> 2023-12-04 ...
  - Lấy chunk 2023-12-05 -> 2024-12-04 ...
  - Lấy chunk 2024-12-05 -> 2025-10-01 ...
  ✓ Hoàn tất 12 chunk, tổng 2949 dòng
✓ Lấy thành công 2949 dòng dữ liệu cho VCB từ TCBS
Đang lấy dữ liệu cho mã MBB từ TCBS...
  - Lấy chunk 2013-11-27 -> 2014-11-27 ...
  - Lấy chunk 2014-11-28 -> 2015-11-28 ...
  - Lấy chunk 2015-11-29 -> 2016-11-28 ...
  - Lấy chunk 2016-11-29 -> 2017-11-29 ...
  - Lấy chunk 2017-11-30 -> 2018-11-30 ...
  - Lấy chunk 2018-12-01 -> 2019-12-01 ...
  - Lấy chunk 2019-12-02 -> 2020-12-01 ...
  - Lấy chunk 2020-12-02 -> 2021-12-02 ...
  - Lấy chunk 2021-12-03 -> 2022-12-03 ...
  - Lấy chunk 2022-12-04 -> 2023-12-04 ...
  - Lấy chunk 2023-12-05 -> 2024-12-04 ...
  - Lấy chunk 2024-12-05 -> 2025-10-01 ...
  ✓ Hoàn tất 12 chunk, tổng 2949 dòng
✓ Lấy thành công 2949 dòng dữ liệu cho MBB từ TCBS
Đang lấy dữ liệu cho mã FPT từ TCBS...
  - Lấy chunk 2013-11-27 -> 2014-11-27 ...
  - Lấy chunk 2014-11-28 -> 2015-11-28 ...
  - Lấy chunk 2015-11-29 -> 2016-11-28 ...
  - Lấy chunk 2016-11-29 -> 2017-11-29 ...
  - Lấy chunk 2017-11-30 -> 2018-11-30 ...
  - Lấy chunk 2018-12-01 -> 2019-12-01 ...
  - Lấy chunk 2019-12-02 -> 2020-12-01 ...
  - Lấy chunk 2020-12-02 -> 2021-12-02 ...
  - Lấy chunk 2021-12-03 -> 2022-12-03 ...
  - Lấy chunk 2022-12-04 -> 2023-12-04 ...
  - Lấy chunk 2023-12-05 -> 2024-12-04 ...
  - Lấy chunk 2024-12-05 -> 2025-10-01 ...
  ✓ Hoàn tất 12 chunk, tổng 2949 dòng
✓ Lấy thành công 2949 dòng dữ liệu cho FPT từ TCBS

Xử lý mã ACB...
Đang tính toán chỉ số kỹ thuật...
✓ Đã tính toán xong các chỉ số kỹ thuật!
  - Số lượng chỉ số đã thêm: 60

Xử lý mã BID...
Đang tính toán chỉ số kỹ thuật...
✓ Đã tính toán xong các chỉ số kỹ thuật!
  - Số lượng chỉ số đã thêm: 60

Xử lý mã FPT...
Đang tính toán chỉ số kỹ thuật...
✓ Đã tính toán xong các chỉ số kỹ thuật!
  - Số lượng chỉ số đã thêm: 60

Xử lý mã MBB...
Đang tính toán chỉ số kỹ thuật...
✓ Đã tính toán xong các chỉ số kỹ thuật!
  - Số lượng chỉ số đã thêm: 60

Xử lý mã VCB...
Đang tính toán chỉ số kỹ thuật...
✓ Đã tính toán xong các chỉ số kỹ thuật!
  - Số lượng chỉ số đã thêm: 60

Đối chiếu số dòng giữa RAW và WITH_INDICATORS...
  - RAW rows: 13381
  - IND rows: 13342
  ! Cảnh báo: số dòng chưa khớp. Sẽ ép khớp lại theo (time,symbol) ở RAW.
  - IND rows sau khi ép khớp: 13381

Loại bỏ cột ít dữ liệu: ['PSAR_up', 'PSAR_down'] (giữ PSAR_filled, PSAR_side)

✓ Đã lưu dữ liệu vào file: stock_data_2025_with_indicators.csv
  - Tổng số dòng: 13381
  - Các cột: time, open, high, low, close, volume, symbol, SMA_5, SMA_10, SMA_20, SMA_50, SMA_200, EMA_5, EMA_10, EMA_20, EMA_50, RSI_14, RSI_7, MACD, MACD_signal, MACD_diff, BB_upper, BB_middle, BB_lower, BB_width, BB_pband, Stoch_K, Stoch_D, ATR_14, ADX, ADX_pos, ADX_neg, OBV, CCI_20, Williams_R, MFI_14, ROC_10, PSAR, PSAR_merged, PSAR_side, PSAR_filled, VWAP, Ichimoku_a, Ichimoku_b, Ichimoku_base, Ichimoku_conv, TRIX, KST, KST_signal, CMF, Force_Index, EOM, Keltner_upper, Keltner_middle, Keltner_lower, Donchian_upper, Donchian_middle, Donchian_lower, Ulcer_Index, Daily_Return, Price_Change, Price_Change_Pct, HL_Range, HL_Range_Pct, Volume_Change_Pct
  - Thời gian: 2015-01-05 00:00:00 đến 2025-10-01 00:00:00

✓ Đã lưu dữ liệu vào file: stock_data_2025_raw.csv
  - Tổng số dòng: 13381
  - Các cột: time, open, high, low, close, volume, symbol
  - Thời gian: 2015-01-05 00:00:00 đến 2025-10-01 00:00:00

======================================================================
MẪU DỮ LIỆU WITH_INDICATORS (5 DÒNG ĐẦU)
======================================================================
        time  open  high   low  close    volume symbol  SMA_5  ...  Donchian_lower  Ulcer_Index  Daily_Return  Price_Change  Price_Change_Pct  HL_Range  HL_Range_Pct  Volume_Change_Pct
0 2015-01-05  2.35  2.34  2.31   2.34   55888.0    ACB  2.344  ...            2.31     1.157757     -0.425532         -0.01         -0.425532      0.03      1.298701          42.013518
1 2015-01-05  5.84  5.89  5.84   5.84   66380.0    BID  5.800  ...            5.66     2.970842      1.388889          0.00          0.000000      0.05      0.856164         -68.998692
2 2015-01-05  7.34  7.37  7.28   7.31  273550.0    FPT  7.164  ...            6.85     4.199246     -0.408719         -0.03         -0.408719      0.09      1.236264         -41.960876
3 2015-01-05  2.31  2.31  2.29   2.29  338650.0    MBB  2.278  ...            2.20     2.719485     -0.865801         -0.02         -0.865801      0.02      0.873362         -55.389135
4 2015-01-05  9.32  9.44  9.23   9.38  310010.0    VCB  9.306  ...            8.32     4.332228      0.000000          0.06          0.643777      0.21      2.275190         -63.710112

[5 rows x 65 columns]

======================================================================
HOÀN THÀNH!
======================================================================
