======================================================================
LOG file: logs/stock_data_20251026_150520.log
Start time: 2025-10-26 15:05:20
======================================================================
======================================================================
CHƯƠNG TRÌNH LẤY DỮ LIỆU CỔ PHIẾU TỪ VNSTOCK
======================================================================
Các mã cổ phiếu: ACB, BID, VCB, MBB, FPT
Thời gian: 2023-01-01 đến 2025-10-01
======================================================================

Đang lấy dữ liệu cho mã ACB từ TCBS...
  - Lấy chunk 2023-01-01 -> 2024-01-01 ...
  - Lấy chunk 2024-01-02 -> 2025-01-01 ...
  - Lấy chunk 2025-01-02 -> 2025-10-01 ...
  ✓ Hoàn tất 3 chunk, tổng 684 dòng
✓ Lấy thành công 684 dòng dữ liệu cho ACB từ TCBS
Đang lấy dữ liệu cho mã BID từ TCBS...
  - Lấy chunk 2023-01-01 -> 2024-01-01 ...
  - Lấy chunk 2024-01-02 -> 2025-01-01 ...
  - Lấy chunk 2025-01-02 -> 2025-10-01 ...
  ✓ Hoàn tất 3 chunk, tổng 684 dòng
✓ Lấy thành công 684 dòng dữ liệu cho BID từ TCBS
Đang lấy dữ liệu cho mã VCB từ TCBS...
  - Lấy chunk 2023-01-01 -> 2024-01-01 ...
  - Lấy chunk 2024-01-02 -> 2025-01-01 ...
  - Lấy chunk 2025-01-02 -> 2025-10-01 ...
  ✓ Hoàn tất 3 chunk, tổng 684 dòng
✓ Lấy thành công 684 dòng dữ liệu cho VCB từ TCBS
Đang lấy dữ liệu cho mã MBB từ TCBS...
  - Lấy chunk 2023-01-01 -> 2024-01-01 ...
  - Lấy chunk 2024-01-02 -> 2025-01-01 ...
  - Lấy chunk 2025-01-02 -> 2025-10-01 ...
  ✓ Hoàn tất 3 chunk, tổng 684 dòng
✓ Lấy thành công 684 dòng dữ liệu cho MBB từ TCBS
Đang lấy dữ liệu cho mã FPT từ TCBS...
  - Lấy chunk 2023-01-01 -> 2024-01-01 ...
  - Lấy chunk 2024-01-02 -> 2025-01-01 ...
  - Lấy chunk 2025-01-02 -> 2025-10-01 ...
  ✓ Hoàn tất 3 chunk, tổng 684 dòng
✓ Lấy thành công 684 dòng dữ liệu cho FPT từ TCBS

======================================================================
THỐNG KÊ DỮ LIỆU
======================================================================
Tổng số dòng (RAW): 3415

Số dòng theo từng mã cổ phiếu:
symbol
ACB    683
BID    683
FPT    683
MBB    683
VCB    683
Name: count, dtype: int64

Mẫu dữ liệu (5 dòng đầu):
        time   open   high    low  close   volume symbol
0 2023-01-03  12.90  13.31  12.87  13.31  1550148    ACB
1 2023-01-03  28.50  29.88  28.32  29.88  1734902    BID
2 2023-01-03  48.31  50.26  48.25  50.26  1538861    FPT
3 2023-01-03   9.32   9.75   9.32   9.75  7544261    MBB
4 2023-01-03  45.10  46.44  45.10  46.44  1090345    VCB

======================================================================
TÍNH TOÁN CHỈ SỐ KỸ THUẬT
======================================================================
Lấy thêm lookback từ: 2021-11-27 đến 2025-10-01 để tính chỉ báo dài, nhưng output sẽ bị cắt về [2023-01-01..2025-10-01].
Đang lấy dữ liệu cho mã ACB từ TCBS...
  - Lấy chunk 2021-11-27 -> 2022-11-27 ...
  - Lấy chunk 2022-11-28 -> 2023-11-28 ...
  - Lấy chunk 2023-11-29 -> 2024-11-28 ...
  - Lấy chunk 2024-11-29 -> 2025-10-01 ...
  ✓ Hoàn tất 4 chunk, tổng 957 dòng
✓ Lấy thành công 957 dòng dữ liệu cho ACB từ TCBS
Đang lấy dữ liệu cho mã BID từ TCBS...
  - Lấy chunk 2021-11-27 -> 2022-11-27 ...
  - Lấy chunk 2022-11-28 -> 2023-11-28 ...
  - Lấy chunk 2023-11-29 -> 2024-11-28 ...
  - Lấy chunk 2024-11-29 -> 2025-10-01 ...
  ✓ Hoàn tất 4 chunk, tổng 957 dòng
✓ Lấy thành công 957 dòng dữ liệu cho BID từ TCBS
Đang lấy dữ liệu cho mã VCB từ TCBS...
  - Lấy chunk 2021-11-27 -> 2022-11-27 ...
  - Lấy chunk 2022-11-28 -> 2023-11-28 ...
  - Lấy chunk 2023-11-29 -> 2024-11-28 ...
  - Lấy chunk 2024-11-29 -> 2025-10-01 ...
  ✓ Hoàn tất 4 chunk, tổng 957 dòng
✓ Lấy thành công 957 dòng dữ liệu cho VCB từ TCBS
Đang lấy dữ liệu cho mã MBB từ TCBS...
  - Lấy chunk 2021-11-27 -> 2022-11-27 ...
  - Lấy chunk 2022-11-28 -> 2023-11-28 ...
  - Lấy chunk 2023-11-29 -> 2024-11-28 ...
  - Lấy chunk 2024-11-29 -> 2025-10-01 ...
  ✓ Hoàn tất 4 chunk, tổng 957 dòng
✓ Lấy thành công 957 dòng dữ liệu cho MBB từ TCBS
Đang lấy dữ liệu cho mã FPT từ TCBS...
  - Lấy chunk 2021-11-27 -> 2022-11-27 ...
  - Lấy chunk 2022-11-28 -> 2023-11-28 ...
  - Lấy chunk 2023-11-29 -> 2024-11-28 ...
  - Lấy chunk 2024-11-29 -> 2025-10-01 ...
  ✓ Hoàn tất 4 chunk, tổng 957 dòng
✓ Lấy thành công 957 dòng dữ liệu cho FPT từ TCBS

Xử lý mã ACB...
Đang tính toán chỉ số kỹ thuật...
✓ Đã tính toán xong các chỉ số kỹ thuật!
  - Số lượng chỉ số đã thêm: 60

Xử lý mã BID...
Đang tính toán chỉ số kỹ thuật...
✓ Đã tính toán xong các chỉ số kỹ thuật!
  - Số lượng chỉ số đã thêm: 60

Xử lý mã FPT...
Đang tính toán chỉ số kỹ thuật...
✓ Đã tính toán xong các chỉ số kỹ thuật!
  - Số lượng chỉ số đã thêm: 60

Xử lý mã MBB...
Đang tính toán chỉ số kỹ thuật...
✓ Đã tính toán xong các chỉ số kỹ thuật!
  - Số lượng chỉ số đã thêm: 60

Xử lý mã VCB...
Đang tính toán chỉ số kỹ thuật...
✓ Đã tính toán xong các chỉ số kỹ thuật!
  - Số lượng chỉ số đã thêm: 60

Đối chiếu số dòng giữa RAW và WITH_INDICATORS...
  - RAW rows: 3415
  - IND rows: 3415

Loại bỏ cột ít dữ liệu: ['PSAR_up', 'PSAR_down'] (giữ PSAR_filled, PSAR_side)

✓ Đã lưu dữ liệu vào file: stock_data_2025_with_indicators.csv
  - Tổng số dòng: 3415
  - Các cột: time, open, high, low, close, volume, symbol, SMA_5, SMA_10, SMA_20, SMA_50, SMA_200, EMA_5, EMA_10, EMA_20, EMA_50, RSI_14, RSI_7, MACD, MACD_signal, MACD_diff, BB_upper, BB_middle, BB_lower, BB_width, BB_pband, Stoch_K, Stoch_D, ATR_14, ADX, ADX_pos, ADX_neg, OBV, CCI_20, Williams_R, MFI_14, ROC_10, PSAR, PSAR_merged, PSAR_side, PSAR_filled, VWAP, Ichimoku_a, Ichimoku_b, Ichimoku_base, Ichimoku_conv, TRIX, KST, KST_signal, CMF, Force_Index, EOM, Keltner_upper, Keltner_middle, Keltner_lower, Donchian_upper, Donchian_middle, Donchian_lower, Ulcer_Index, Daily_Return, Price_Change, Price_Change_Pct, HL_Range, HL_Range_Pct, Volume_Change_Pct
  - Thời gian: 2023-01-03 00:00:00 đến 2025-10-01 00:00:00

✓ Đã lưu dữ liệu vào file: stock_data_2025_raw.csv
  - Tổng số dòng: 3415
  - Các cột: time, open, high, low, close, volume, symbol
  - Thời gian: 2023-01-03 00:00:00 đến 2025-10-01 00:00:00

======================================================================
MẪU DỮ LIỆU WITH_INDICATORS (5 DÒNG ĐẦU)
======================================================================
        time   open   high    low  close   volume  ... Daily_Return  Price_Change  Price_Change_Pct  HL_Range  HL_Range_Pct  Volume_Change_Pct
0 2023-01-03  12.90  13.31  12.87  13.31  1550148  ...     3.660436          0.41          3.178295      0.44      3.418803          15.602369
1 2023-01-03  28.50  29.88  28.32  29.88  1734902  ...     6.714286          1.38          4.842105      1.56      5.508475         -33.764695
2 2023-01-03  48.31  50.26  48.25  50.26  1538861  ...     4.036431          1.95          4.036431      2.01      4.165803         144.372649
3 2023-01-03   9.32   9.75   9.32   9.75  7544261  ...     5.291577          0.43          4.613734      0.43      4.613734          82.584964
4 2023-01-03  45.10  46.44  45.10  46.44  1090345  ...     3.245887          1.34          2.971175      1.34      2.971175         -27.912600

[5 rows x 65 columns]

======================================================================
HOÀN THÀNH!
======================================================================
